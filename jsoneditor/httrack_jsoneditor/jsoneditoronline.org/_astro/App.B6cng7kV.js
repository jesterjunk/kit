const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/JSONEditorPanel.yFWDitjL.js","_astro/jsx-runtime.D_zvdyIk.js","_astro/floating-ui.dom.BVVWGuUJ.js","_astro/isEmpty.yPRxPQfS.js","_astro/index.BGd5Ky0j.js","_astro/debug.DRjTZKen.js","_astro/_commonjsHelpers.CqkleIqs.js","_astro/index.BqJQxrZM.js","_astro/JSONEditorComponent.bUYtOSjE.js","_astro/index.B2YNouON.js","_astro/index.-DrlcFrU.js","_astro/json-schema-draft-06.BUXeb-dj.js","_astro/preload-helper.CLcXU_4U.js","_astro/fontUtils.BV5T5L3M.js","_astro/modal.Bkg2kDE0.js","_astro/useConfig.Dv4xtEmJ.js","_astro/client.VHhTgbqr.js","_astro/prompt.lRC3jknX.js","_astro/csv2json.D_hONyjZ.js","_astro/constants.DLPHiTRJ.js","_astro/PricingPlansModal.CsfcNgzq.js","_astro/PricingTable.C-drzN-W.js","_astro/JSONEditorPanel.DFsqhqUZ.css"])))=>i.map(i=>d[i]);
import{_ as Sn}from"./preload-helper.CLcXU_4U.js";import{j as r}from"./jsx-runtime.D_zvdyIk.js";import{G as Cn,Y as Ln,Z as dt,_ as ft,I as bn,F as En,E as xn,z as jn}from"./index.BGd5Ky0j.js";import{c as he,L as ze,D as ie,F as He,M as mt,a as de,b as Zt,B as Dn,A as Lt,T as nt,d as ye,e as xe,f as bt,g as Et,R as xt,h as Pn,i as Tn,j as _n}from"./debug.DRjTZKen.js";import{r as w,R as Rn}from"./index.BqJQxrZM.js";import{M as en,a as jt,b as De,c as tn,R as Pe,d as nn,S as Nn,P as ot,C as qe}from"./constants.DLPHiTRJ.js";import{l as pt,s as Ge,t as Je,c as Fn,a as An,f as On,i as Dt,d as Mn,g as kn,b as Kn,u as Pt,e as $n,h as In,j as Tt,k as Un,m as ue,M as on,n as Te,p as qn,r as Qn,o as Vn,q as zn,v as Hn,w as Jn,x as Yn,y as _t,z as Rt,A as Bn}from"./modal.Bkg2kDE0.js";import{u as Xn,a as Fe}from"./useConfig.Dv4xtEmJ.js";import{i as Gn,a as Wn,s as je,c as te,b as yt,k as Zn,g as eo,l as to,d as ht,f as Ye,e as no,h as Nt,j as Qe,m as oo,n as rn,o as ro,p as rt,q as we,r as st,t as Ft,u as at,v as At,w as ct,x as so,y as ao,z as co,A as io,B as uo,C as lo,D as fo,S as mo,E as ho,F as it,G as Ot,H as go,I as po,J as Mt}from"./fontUtils.BV5T5L3M.js";import{i as _e,l as yo,a as wo}from"./floating-ui.dom.BVVWGuUJ.js";import{g as vo}from"./_commonjsHelpers.CqkleIqs.js";import{P as So}from"./PricingPlansModal.CsfcNgzq.js";import{i as wt}from"./isEmpty.yPRxPQfS.js";var Se=(e=>(e.text="text",e.tree="tree",e.table="table",e))(Se||{});const sn=he("jsoneditoronline:recentFiles"),vt="recentFiles",Co="files",Lo=1e3;function ge(e,t){const o=te(e,t._id);sn("updateRecentFile",{compoundKey:o});const i=St().filter(g=>!yt(g)||g.compoundKey!==o),f={...xo(e,t),viewed:new Date().toISOString()};i.unshift(f),Ge(vt,Eo(i,Lo))}function ut(e){sn("removeRecentFile",{compoundKey:e});const t=St().filter(o=>!yt(o)||o.compoundKey!==e);Ge(vt,t)}function St(){const e=pt(vt);if(e)return e.map(o=>Gn(o)?jo(o):Wn(o)?Do(o):o);const t=bo();return t||[]}function bo(){const e=pt(Co);if(e)return Object.values(e).map(Po)}function Eo(e,t){return e.slice(0,t)}function xo(e,t){return{compoundKey:te(e,t._id),documentSource:e,document:t}}function jo(e){const{documentSource:t,documentId:o}=je(e.compoundKey);if(!t||!o)throw new Error("Cannot migrate legacy file");return{compoundKey:e.compoundKey,documentSource:t,document:{_id:o,_rev:1,name:e.name,size:0,access:[],schema:{type:"none"},created:e.updated,updated:e.updated,viewed:e.accessed}}}function Do(e){return{compoundKey:te(e.source,e.id),documentSource:e.source,document:{_id:e.id,_rev:1,name:e.name,size:0,access:[],schema:{type:"none"},created:e.updated,updated:e.updated,viewed:e.accessed}}}function Po(e){return{compoundKey:te("cloud",e._id),documentSource:"cloud",document:{_id:e._id,_rev:1,name:e.name,size:0,access:[],schema:{type:"none"},created:e.updated,updated:e.updated,viewed:e.updated}}}const an="Are you running in private mode or is the browser history disabled?";async function To(e){try{return await eo(e)}catch(t){throw console.error(t),cn(t)?new Error("Failed to load document from local database. "+an):t}}async function _o(){try{return await Zn()}catch(e){throw console.error(e),cn(e)?new Error("Failed to load document keys from local database. "+an):e}}function cn(e){return e&&e.name==="InvalidStateError"&&e.message==="A mutation operation was attempted on a database that did not allow mutations."}const Ae=he("jsoneditoronline:migrationUtils");async function un(){const e=Date.now();try{const t=await _o();Ae(`migrating ${t.length} local documents to V2`);const o=new Set(await to()),i=t.filter(L=>!o.has(L)),f=t.length-i.length;f>0&&Ae(`ignoring ${f} local documents because they already exist in V2`);for(const L of i)try{const h=await To(L),{document:b,contentText:P}=Ro(h);await ht(b,P),Ae(`Successfully migrated document with id ${L} (size: ${Ye(b.size)})`)}catch(h){console.error(`Failed to migrate document with id ${L}`),console.error(h)}const g=Date.now();Ae(`migrated ${i} documents in ${g-e} ms`)}catch(t){Ae("migration errored"),console.error(t)}}function Ro(e){if(!e)throw new Error("Cannot migrate document: undefined");if(no(e)){const i=Je(e.content).text;return{...e},{document:e,contentText:i}}const t=new Date().toISOString(),o=e.content?Je(e.content).text:"";return{document:{_id:e._id,_rev:1,name:e.name||"",size:o.length,access:[{public:!0}],schema:No(e.schema),created:e.updated||t,updated:e.updated||t,viewed:e.updated||t},contentText:o}}function No(e){if(e===void 0)return ve;if(e.type.toLowerCase()===e.type)return e;switch(e.type){case"NONE":return ve;case"URL":return e.url?{type:"url",url:e.url}:ve;case"DOCUMENT":return e.compoundKey?{type:"document",compoundKey:e.compoundKey}:ve;case"TEXT":return e.content?{type:"content",content:e.content}:ve;case"PANEL":return e.panelId?{type:"panel",panelId:e.panelId}:ve;default:return ve}}const ve={type:"none"};function ln(){function e(){return Fo(window.location.hash.substring(1))}function t(u){const l=Ao(u);window.location.hash=l.length?"#"+l:""}function o(u,l){const C=e();if(C.query[u]!==l)if(l!==void 0){const R={...C.query,[u]:l};t({...C,query:R})}else{const R={...C.query};delete R[u],t({...C,query:R})}}function i(u){return e().query[u]}function f(u){const l=e();!_e(l.query,u)&&t({...l,query:u})}function g(){return e().query}function L(u){const l=e();l.section!==u&&t({...l,section:u})}function h(){return e().section}function b(u){const l=e();l.query[u]&&(delete l.query[u],t(l))}let P=[],M=e();function H(){const u=e();P.forEach(l=>{try{l(u,M)}catch(C){console.error(C)}}),M=u}function X(u){return P.length===0&&window.addEventListener("hashchange",H),P.push(u),u}function d(u,l){return X((C,S)=>{C.query[u]!==S.query[u]&&l(C.query[u])})}function p(u){return X((l,C)=>{l.section!==C.section&&u(l.section)})}function y(u){P=P.filter(l=>l!==u)}function v(){window.removeEventListener("hashchange",H)}return{getHash:e,setHash:t,getQueryParam:i,setQueryParam:o,getQueryParams:g,setQueryParams:f,getSection:h,setSection:L,onChangeHash:X,onChangeQueryParam:d,onChangeSection:p,removeListener:y,removeQueryParam:b,destroy:v}}function gt(e){const t=e.split("&").filter(o=>o.length>0).map(o=>o.split("=").map(decodeURIComponent));return Object.fromEntries(t)}function dn(e){return Object.entries(e).map(t=>t.map(encodeURIComponent).join("=")).join("&")}function Fo(e){const t=e.startsWith("/");if(t||e.includes("?")){const[o,i]=e.split("?"),f=i?gt(i):{};return t?{section:o,query:f}:{query:f}}else return{query:gt(e)}}function Ao(e){const t=dn(e.query);return e.section&&e.section.startsWith("/")?t?`${e.section}?${t}`:e.section:t}const kt=he("jsoneditoronline:useHash");function Oo(){const e=w.useRef(ln());return w.useEffect(()=>(kt("create useHash"),()=>{kt("destroy useHash"),e.current.destroy()}),[]),e.current}function fn(){const e=w.useRef(null),t=w.useCallback(function(){e.current!=null&&(window.clearTimeout(e.current),e.current=null)},[]),o=w.useCallback(function(i,f){e.current!=null&&(window.clearTimeout(e.current),e.current=null),e.current=window.setTimeout(i,f)},[]);return w.useEffect(()=>()=>{t()},[t]),[o,t]}const A=he("jsoneditoronline:useDocumentProvider"),Mo=1e3,ko=4e3,Kt="firstTimeUse",Ko={array:[1,2,3],boolean:!0,color:"gold",null:null,number:123,object:{a:"b",c:"d"},string:"Hello World"};function $t(e){const t=Oo(),[o,i]=w.useState(null),f=w.useRef(o),[g,L]=w.useState(1),[h,b]=w.useState(null),[P,M]=w.useState({text:""}),[H,X]=w.useState(null),[d,p]=w.useState(null),[y,v]=w.useState(!1),[u,l]=w.useState(!1),[C,S]=w.useState(null),[R]=fn(),[x,m]=w.useState(null),[q,Q]=w.useState(e.parserId),[J,I]=w.useState(Nt(q,0)),K=o?je(o).documentSource:null,oe=h?h.size>ze:!1;function W(){return t.getQueryParam(e.hashKey)??null}w.useEffect(()=>{const n=t.onChangeQueryParam(e.hashKey,a=>{const s=a===void 0?null:a;s!==f.current&&(A("hash changed -> load document",{newValue:s,oldValue:f.current}),s?B(s).catch(console.error):k().catch(console.error))});return()=>{t.removeListener(n)}},[e.hashKey,t,C,B,k]),w.useEffect(()=>{const n=W();A("mount",{hashKey:e.hashKey,compoundKeyFromUrl:n}),f.current=n,i(n),n?B(n).catch(console.error):e.loadDefaultDocumentOnFirstUse&&pt(Kt)!==!1&&V({compoundKey:null,document:null,contentText:JSON.stringify(Ko,null,e.indentation)})},[]),w.useEffect(()=>{function n(a){(y||x)&&(A("beforeunload: there are unsaved changes"),a.preventDefault(),a.returnValue="You have unsaved changes. Are you sure you want to leave the page?",R(()=>{G.current().catch(s=>console.error(s))},0))}return window.addEventListener("beforeunload",n),()=>{window.removeEventListener("beforeunload",n)}},[y,x]);function j(n){Dt(n)&&n.status===401?at(n,{text:"Sign in again",onClick:e.signIn}):Dt(n)&&n.status===403&&n.message.toLowerCase().includes("no active subscription")?at(n,{text:"Subscribe again",onClick:e.subscribe}):at(n)}async function k({name:n=void 0}={}){if(A("new document"),!!await Ee())if(!n)V({compoundKey:null,document:null,contentText:""});else{const s="",D=Qe({name:n,size:s.length});V({compoundKey:te("local",D._id),document:D,contentText:s})}}async function $({name:n,content:a}){const s=Je(a,e.indentation,J).text;await Ke({document:Qe({name:n,size:s.length}),contentText:s})}async function B(n){if(!oo(n)){U({compoundKey:n,error:new Error(`Cannot load document with id "${n}", expecting a compound key "local.id" or "cloud.id".`),silent:!0});return}const{documentSource:a,documentId:s}=je(n);if(!s){const D=new Error("Cannot load document: no document id");console.error(D),j(D);return}switch(a){case ie.CLOUD:A(`load from cloud: ${s}`),await ce(s,{silent:!0});return;case ie.LOCAL:A(`load locally: ${s}`),await N(s,{silent:!0});return;case ie.JSON:A(`load json: ${s}`),O(s);return;case ie.URL:A(`load url: ${s}`),await le(s);return;default:U({compoundKey:n,error:new Error(`Cannot load document with id "${n}", unknown document source "${a}". Known sources: "local", "cloud", "url", or "json".`),silent:!0})}}async function N(n,{silent:a}={silent:!1}){l(!0);try{const s=await rn(n)??await $o(n),D=await ro(n);if(s===void 0||D===void 0){U({compoundKey:te("local",n),error:Fn({message:`Local document with id "${te("local",n)}" not found`,reasons:["Did you delete this local document?","Did you save this local document in the cloud instead?","Did you clean offline storage of your browser recently?","Did someone share a url of a local document located on his/her browser and not yours?"],status:void 0}),silent:a});return}const F=new Date().toISOString(),ne={...s,viewed:F};V({compoundKey:te("local",ne._id),document:ne,contentText:D}),await rt(ne),a||we(`Document "${s.name}" loaded.`)}catch(s){U({compoundKey:te("local",n),error:s,silent:a})}finally{l(!1)}}function O(n){A("loadFromJson",{jsonText:n}),V({compoundKey:te("json",n),document:null,contentText:n})}function V(n){L(s=>s+1),Q(e.parserId),I(Nt(e.parserId,n.contentText.length)),f.current=n.compoundKey,i(n.compoundKey),b(n.document),M({text:n.contentText}),p(n.loadedName||null),X(n.loadedUrl||null),S(null),m(null),t.setQueryParam(e.hashKey,n.compoundKey??void 0);const a=n.compoundKey?je(n.compoundKey).documentSource:null;a&&n.document&&ge(a,n.document)}function Z(n){const a=te(n.documentSource,n.document._id);f.current=a,i(a),b(n.document),t.setQueryParam(e.hashKey,a??void 0),K&&n.document&&ge(n.documentSource,n.document)}function U(n){L(a=>a+1),f.current=n.compoundKey,i(n.compoundKey),b(null),M({text:""}),l(!1),v(!1),S(n.error),t.setQueryParam(e.hashKey,n.compoundKey??void 0),console.error(n.error),n.silent||j(n.error)}async function Y({updatedName:n=void 0,silent:a=!0,force:s=!1}={}){if(A("save",{updatedName:n,silent:a,force:s}),e.loadDefaultDocumentOnFirstUse&&Ge(Kt,!1),!y&&!s)return!0;try{switch(K){case ie.CLOUD:return await re({updatedName:n,silent:a});case ie.LOCAL:case ie.URL:case ie.JSON:case null:return await se({updatedName:n,silent:a});default:{const D=new Error(`Cannot save changes, unknown document source "${K}".  Known sources: "local", "cloud", "url", or "json".`);return console.error(D),j(D),!1}}}catch(D){return console.error(D),j(D),!1}}const G=w.useRef(Y);G.current=Y;function ee(){A("saveDebounced",y);const n=oe||o&&uo(o)?ko:Mo;R(()=>G.current(),n)}async function se({updatedName:n=void 0,silent:a=!1}={}){A(`save document locally (_id: ${h?._id||"-"})`);const s=a?null:st("Saving document...");try{const D=n??h?.name??d??await io(),F=Je(P,e.indentation,J).text,ne=F.length,Ie=h?ct(h,{size:ne}):Qe({name:D,size:ne});return await tt({document:Ie,contentText:F,silent:a}),!0}catch(D){return m(String(D)),!1}finally{v(!1),s&&s.close()}}async function ce(n,{silent:a}={silent:!1}){if(A(`Load cloud document with id ${n}...`),!await Ee())return;const D=a?null:st("Loading document...");try{l(!0);const{document:F,contentText:ne}=await An(n);V({compoundKey:te("cloud",F._id),document:F,contentText:ne}),A("Loaded document",F)}catch(F){U({compoundKey:te("cloud",n),error:F,silent:a})}finally{l(!1),D?.close()}}async function re({updatedName:n=void 0,silent:a=!1}={}){const s=n??h?.name??d??"New Document";A(`save document data to cloud (compoundKey: ${o}, name: ${s})`);const D=a?null:st("Saving document...");try{if(h)if(K==="cloud"){n!==void 0&&await Pt(h._id,s);const F=await Un(h._id,P,J,e.indentation);b(F),ge("cloud",F),A("Updated existing document data"),a||we(`Document "${F.name}" saved.`)}else{const F=await Tt(s,P,h.schema,J,e.indentation);Z({documentSource:"cloud",document:F});const ne=h._id;await At(ne),ut(te("local",ne)),A("Converted local document into a cloud document",{localId:ne,cloudId:F._id,name:F.name}),a||we(`Document "${F.name}" saved.`)}else{const F=await Tt(s,P,{type:"none"},J,e.indentation);Z({documentSource:"cloud",document:F})}return!0}catch(F){return console.error(F),j(F),!1}finally{v(!1),D?.close()}}async function le(n){if(await Ee()){A("Loading file from url...",{url:n}),l(!0);try{const s=Ft(yo(n.split("/")),".json"),D=await On(n);V({compoundKey:te("url",n),document:null,contentText:D,loadedName:s,loadedUrl:n}),A("Loaded file from url",{name:s})}catch(s){U({compoundKey:te("url",n),error:s,silent:!1})}finally{l(!1)}}}async function Le(n,a){A("Saving document to url...",{url:n,formatting:a});try{const s=await $e(P,a),D=await window.fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:s}),F=await D.text();D.status>=200&&D.status<300?(A("Document successfully saved to url"),we("Document successfully saved to url.")):j(new Error(D.status+" "+D.statusText+" "+F))}catch(s){console.error(s),j(s)}}async function be(n){if(await Ee()){A("Loading file from disk...",{file:n}),l(!0);try{const{name:s,data:D}=await co(n),F=Ft(s,".json"),ne=D.length;await Ke({document:Qe({name:F,size:ne}),contentText:D}),A("Loaded file from disk",{name:F})}catch(s){U({compoundKey:null,error:s,silent:!1})}finally{l(!1)}}}async function pe(n,a){A("saving document to disk...",{name:n,formatting:a});try{const s=so(n,".json"),D=await $e(P,a);ao(s,D)}catch(s){console.error(s),j(s)}}async function Oe(n,a=!1){A("updateContent",{saveImmediately:a}),M(n),v(!0),a?await Y({force:!0}):x||ee()}async function Ne(n){if(A("updateName",{name:n}),!h){const s=new Error("Cannot update name: create a document first");console.error(s),j(s);return}const a=h;try{if(K==="cloud"){b({...a,name:n});const s=await Pt(h._id,n);b(s),ge("cloud",s)}else{const s=ct(h,{name:n});await rt(s),b(s),ge("local",s)}}catch(s){b(a),console.error(s),j(s)}}async function Me(n){if(A("updateSchema",{schema:n}),!h){const s=new Error("Cannot update schema: create a document first");console.error(s),j(s);return}const a=h;try{if(K==="cloud"){b({...a,schema:n});const s=await In(h._id,n,J,e.indentation);b(s),ge("cloud",s)}else{const s=ct(h,{schema:n});await rt(s),b(s),ge("local",s)}}catch(s){b(a),console.error(s),j(s)}}async function We(n){if(A("updateAccess",{access:n}),!h){const s=new Error("Cannot update access: create a document first");console.error(s),j(s);return}const a=h;try{if(K==="cloud"){b({...a,access:n});const s=await $n(h._id,n);b(s),ge("cloud",s)}else console.error("Cannot update access: no cloud document")}catch(s){b(a),console.error(s),j(s)}}async function Ze(n){A("forgetDocument",n);try{const{documentSource:a,documentId:s}=je(n);if(a!==ie.CLOUD){const F=new Error("Cannot forget document: it is not a cloud document");console.error(F),j(F);return}ut(n),await kn()&&await Kn(s),we("Document successfully forgotten.")}catch(a){console.error(a),j(a)}}async function et(n){A("deleteDocument",n);try{v(!1),ut(n);const{documentSource:a,documentId:s}=je(n);switch(a){case ie.LOCAL:await At(s);break;case ie.CLOUD:await Mn(s);break;default:{const D=new Error(`Cannot delete document, unknown document source "${a}".  Known sources: "local", "cloud", "url", or "json".`);console.error(D),j(D);return}}we("Document successfully deleted.")}catch(a){console.error(a),j(a)}}function ke(){A("closeDocument"),V({compoundKey:null,document:null,contentText:""})}async function Ke(n){const a=n.contentText.length;a>mt?(V({compoundKey:null,document:null,contentText:n.contentText,loadedName:n.document.name}),m(It(a))):(await ht(n.document,n.contentText),V({compoundKey:te("local",n.document._id),document:n.document,contentText:n.contentText}))}async function tt(n){const a=n.contentText.length;if(a>mt)return m(It(a)),n.silent||j(new Error("The JSON document is too large to store locally in your browser")),!1;await ht(n.document,n.contentText),Z({documentSource:"local",document:n.document}),A("Saved local document",n.document._id),m(null),n.silent||we(`Document "${n.document.name}" saved locally.`)}async function Ee(){return(y?await Y():!x)?!0:confirm("You have unsaved data, are you sure you want to open a new file?")}function $e(n,a){try{return lo(n,{formatting:a,parser:J,indentation:e.indentation,maxLineLength:e.maxLineLength})}catch(s){if(a===He.FORMAT||a===He.SMART||a===He.COMPACT){const D=`Failed to ${a} the document. Fix the document or select "Indentation: keep as-is", then try to save it again. `+String(s);throw new Error(D)}else throw s}}return{documentSequenceNr:g,compoundKey:o,documentSource:K,document:h,content:P,parserId:q,parser:J,loadedName:d,loadedUrl:H,saving:y,loading:u,error:C,localStorageError:x,newDocument:k,newDocumentWithContent:$,load:B,save:Y,saveToCloud:re,loadFromUrl:le,saveToUrl:Le,loadFromDisk:be,saveToDisk:pe,updateContent:Oe,updateSchema:Me,updateAccess:We,updateName:Ne,forgetDocument:Ze,deleteDocument:et,closeDocument:ke}}function It(e){return`The JSON document is too large to store locally in your browser, and will be lost when closing the browser. Make sure you save the document yourself. (actual size: ${Ye(e)}, maximum size: ${Ye(mt)}).`}async function $o(e){try{return await un(),rn(e)}catch(t){console.error("Failed to migrate and load a legacy document"),console.error(t)}}const Ut=he("jsoneditoronline:useSplitter");function Io({setSplitterValue:e,onClick:t,refContainer:o,refSplitter:i}){w.useEffect(()=>{if(!i||!i.current||!o||!o.current)return;const f=o.current,g=i.current,L={startMouseX:null,startSplitterX:null,offsetX:null,mouseMoved:!1};function h(b){b.preventDefault();const P=f.getBoundingClientRect(),M=g.getBoundingClientRect();L.startMouseX=b.clientX,L.startSplitterX=M.left,L.offsetX=L.startSplitterX-L.startMouseX,L.mouseMoved=!1,Ut("pointer down",b.clientX);function H(d){d.preventDefault();const p=d.clientX+L.offsetX,y=P.width-M.width,v=y>0?(p-P.left)/y:.5;L.mouseMoved=!0,e(v)}function X(d){d.preventDefault(),document.body.removeEventListener("pointermove",H),document.body.removeEventListener("pointerup",X),L.mouseMoved||t(),Ut("pointer up")}document.body.addEventListener("pointermove",H),document.body.addEventListener("pointerup",X)}return g.addEventListener("pointerdown",h),()=>{g.removeEventListener("pointerdown",h)}},[o,i,e])}const qt=he("jsoneditoronline:useSystemTheme");function Uo(){const[e]=w.useState(window.matchMedia("(prefers-color-scheme: dark)")),[t,o]=w.useState(()=>{const i=Qt(e);return qt(`Initial system theme: ${i}`),i});return w.useEffect(()=>{function i(f){const g=Qt(f);g!==t&&(qt(`System theme changed from ${t} to ${g}`),o(g))}return e.addEventListener("change",i),()=>{e.removeEventListener("change",i)}}),t}function Qt(e){return e.matches?"dark":"light"}function Vt({mode:e}){return r.jsxs("div",{className:"panel placeholder",children:[r.jsx("div",{className:"panel-menu"}),r.jsx("div",{className:"panel-contents",children:r.jsx("div",{className:"jsoneditor-react-container",children:r.jsx("div",{className:"jse-main",children:r.jsxs("div",{className:"jse-text-mode",children:[r.jsx("div",{className:"jse-menu"}),e==="tree"&&r.jsx(r.Fragment,{children:r.jsx("div",{className:"jse-navigation-bar"})}),r.jsxs("div",{className:"jse-contents",children:[e==="text"&&r.jsx(r.Fragment,{children:r.jsx("div",{className:"placeholder-gutter"})}),r.jsx("div",{className:"placeholder-contents",children:r.jsxs("div",{className:"placeholder-loading",children:[r.jsx(de,{icon:Cn,spin:!0,fixedWidth:!0})," loading..."]})})]}),e==="text"&&r.jsx("div",{className:"jse-status-bar"})]})})})})]})}class zt extends w.PureComponent{constructor(t){super(t),this.state={error:void 0}}static getDerivedStateFromError(t){return{error:t}}componentDidCatch(t,o){console.error(t,o)}render(){return this.state.error?r.jsxs("div",{className:"error-boundary",children:[r.jsx("div",{children:"Something went wrong. Please reload the application."}),r.jsx("div",{children:this.state.error.toString()})]}):this.props.children}}function qo({error:e}){const t=fo();return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"diff-error","data-tooltip-id":t,children:["Diff: Error ",r.jsx(de,{icon:Ln})]}),r.jsx(mo,{id:t,children:e.toString()})]})}var Ve={},Ht;function Qo(){if(Ht)return Ve;Ht=1,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.default=X;const e="diff-sequences",t=0,o=(d,p,y,v,u)=>{let l=0;for(;d<p&&y<v&&u(d,y);)d+=1,y+=1,l+=1;return l},i=(d,p,y,v,u)=>{let l=0;for(;d<=p&&y<=v&&u(p,v);)p-=1,v-=1,l+=1;return l},f=(d,p,y,v,u,l,C)=>{let S=0,R=-d,x=l[S],m=x;l[S]+=o(x+1,p,v+x-R+1,y,u);const q=d<C?d:C;for(S+=1,R+=2;S<=q;S+=1,R+=2){if(S!==d&&m<l[S])x=l[S];else if(x=m+1,p<=x)return S-1;m=l[S],l[S]=x+o(x+1,p,v+x-R+1,y,u)}return C},g=(d,p,y,v,u,l,C)=>{let S=0,R=d,x=l[S],m=x;l[S]-=i(p,x-1,y,v+x-R-1,u);const q=d<C?d:C;for(S+=1,R-=2;S<=q;S+=1,R-=2){if(S!==d&&l[S]<m)x=l[S];else if(x=m-1,x<p)return S-1;m=l[S],l[S]=x-i(p,x-1,y,v+x-R-1,u)}return C},L=(d,p,y,v,u,l,C,S,R,x,m)=>{const q=v-p,Q=y-p,I=u-v-Q,K=-I-(d-1),oe=-I+(d-1);let W=t;const j=d<S?d:S;for(let k=0,$=-d;k<=j;k+=1,$+=2){const B=k===0||k!==d&&W<C[k],N=B?C[k]:W,O=B?N:N+1,V=q+O-$,Z=o(O+1,y,V+1,u,l),U=O+Z;if(W=C[k],C[k]=U,K<=$&&$<=oe){const Y=(d-1-($+I))/2;if(Y<=x&&R[Y]-1<=U){const G=q+N-(B?$+1:$-1),ee=i(p,N,v,G,l),se=N-ee,ce=G-ee,re=se+1,le=ce+1;m.nChangePreceding=d-1,d-1===re+le-p-v?(m.aEndPreceding=p,m.bEndPreceding=v):(m.aEndPreceding=re,m.bEndPreceding=le),m.nCommonPreceding=ee,ee!==0&&(m.aCommonPreceding=re,m.bCommonPreceding=le),m.nCommonFollowing=Z,Z!==0&&(m.aCommonFollowing=O+1,m.bCommonFollowing=V+1);const Le=U+1,be=V+Z+1;return m.nChangeFollowing=d-1,d-1===y+u-Le-be?(m.aStartFollowing=y,m.bStartFollowing=u):(m.aStartFollowing=Le,m.bStartFollowing=be),!0}}}return!1},h=(d,p,y,v,u,l,C,S,R,x,m)=>{const q=u-y,Q=y-p,I=u-v-Q,K=I-d,oe=I+d;let W=t;const j=d<x?d:x;for(let k=0,$=d;k<=j;k+=1,$-=2){const B=k===0||k!==d&&R[k]<W,N=B?R[k]:W,O=B?N:N-1,V=q+O-$,Z=i(p,O-1,v,V-1,l),U=O-Z;if(W=R[k],R[k]=U,K<=$&&$<=oe){const Y=(d+($-I))/2;if(Y<=S&&U-1<=C[Y]){const G=V-Z;if(m.nChangePreceding=d,d===U+G-p-v?(m.aEndPreceding=p,m.bEndPreceding=v):(m.aEndPreceding=U,m.bEndPreceding=G),m.nCommonPreceding=Z,Z!==0&&(m.aCommonPreceding=U,m.bCommonPreceding=G),m.nChangeFollowing=d-1,d===1)m.nCommonFollowing=0,m.aStartFollowing=y,m.bStartFollowing=u;else{const ee=q+N-(B?$-1:$+1),se=o(N,y,ee,u,l);m.nCommonFollowing=se,se!==0&&(m.aCommonFollowing=N,m.bCommonFollowing=ee);const ce=N+se,re=ee+se;d-1===y+u-ce-re?(m.aStartFollowing=y,m.bStartFollowing=u):(m.aStartFollowing=ce,m.bStartFollowing=re)}return!0}}}return!1},b=(d,p,y,v,u,l,C,S,R)=>{const x=v-p,m=u-y,q=y-p,Q=u-v,J=Q-q;let I=q,K=q;if(C[0]=p-1,S[0]=y,J%2===0){const oe=(d||J)/2,W=(q+Q)/2;for(let j=1;j<=W;j+=1)if(I=f(j,y,u,x,l,C,I),j<oe)K=g(j,p,v,m,l,S,K);else if(h(j,p,y,v,u,l,C,I,S,K,R))return}else{const oe=((d||J)+1)/2,W=(q+Q+1)/2;let j=1;for(I=f(j,y,u,x,l,C,I),j+=1;j<=W;j+=1)if(K=g(j-1,p,v,m,l,S,K),j<oe)I=f(j,y,u,x,l,C,I);else if(L(j,p,y,v,u,l,C,I,S,K,R))return}throw new Error(`${e}: no overlap aStart=${p} aEnd=${y} bStart=${v} bEnd=${u}`)},P=(d,p,y,v,u,l,C,S,R,x)=>{if(u-v<y-p){if(l=!l,l&&C.length===1){const{foundSubsequence:U,isCommon:Y}=C[0];C[1]={foundSubsequence:(G,ee,se)=>{U(G,se,ee)},isCommon:(G,ee)=>Y(ee,G)}}const V=p,Z=y;p=v,y=u,v=V,u=Z}const{foundSubsequence:m,isCommon:q}=C[l?1:0];b(d,p,y,v,u,q,S,R,x);const{nChangePreceding:Q,aEndPreceding:J,bEndPreceding:I,nCommonPreceding:K,aCommonPreceding:oe,bCommonPreceding:W,nCommonFollowing:j,aCommonFollowing:k,bCommonFollowing:$,nChangeFollowing:B,aStartFollowing:N,bStartFollowing:O}=x;p<J&&v<I&&P(Q,p,J,v,I,l,C,S,R,x),K!==0&&m(K,oe,W),j!==0&&m(j,k,$),N<y&&O<u&&P(B,N,y,O,u,l,C,S,R,x)},M=(d,p)=>{if(typeof p!="number")throw new TypeError(`${e}: ${d} typeof ${typeof p} is not a number`);if(!Number.isSafeInteger(p))throw new RangeError(`${e}: ${d} value ${p} is not a safe integer`);if(p<0)throw new RangeError(`${e}: ${d} value ${p} is a negative integer`)},H=(d,p)=>{const y=typeof p;if(y!=="function")throw new TypeError(`${e}: ${d} typeof ${y} is not a function`)};function X(d,p,y,v){M("aLength",d),M("bLength",p),H("isCommon",y),H("foundSubsequence",v);const u=o(0,d,0,p,y);if(u!==0&&v(u,0,0),d!==u||p!==u){const l=u,C=u,S=i(l,d-1,C,p-1,y),R=d-S,x=p-S,m=u+S;d!==m&&p!==m&&P(0,l,R,C,x,!1,[{foundSubsequence:v,isCommon:y}],[t],[t],{aCommonFollowing:t,aCommonPreceding:t,aEndPreceding:t,aStartFollowing:t,bCommonFollowing:t,bCommonPreceding:t,bEndPreceding:t,bStartFollowing:t,nChangeFollowing:t,nChangePreceding:t,nCommonFollowing:t,nCommonPreceding:t}),S!==0&&v(S,R,x)}}return Ve}var Vo=Qo();const zo=vo(Vo);function Re(e){return e.map(t=>"/"+String(t).replace(/~/g,"~0").replace(/\//g,"~1")).join("")}function Ho(e){return Jo(e)&&ue(e)&&!!e.error}function Jo(e){return ue(e)?ue(e.diffLeft)&&ue(e.diffRight)&&Array.isArray(e.changes):!1}const fe="create",Ce="update",me="delete",mn="child-update";function Yo(e,t){const o=Bo(e,t);return{diffLeft:Xo(o),diffRight:Go(o),changes:o}}function Bo(e,t){const o=[];function i(f,g,L,h){if(Array.isArray(f)&&Array.isArray(g)){Wo(f,g,(b,P,M)=>{const H=L.concat([P]),X=h.concat([M]);b===fe?o.push({change:fe,pathRight:X,valueRight:g[M]}):b===Ce?i(f[P],g[M],H,X):b===me&&o.push({change:me,pathLeft:H,valueLeft:f[P]})});return}if(ue(f)&&ue(g)){new Set(Object.keys(f).concat(Object.keys(g))).forEach(P=>{const M=L.concat([P]),H=h.concat([P]);i(f[P],g[P],M,H)});return}if(Jt(f)!==Jt(g)){const b=Array.isArray(f)||ue(f)||Array.isArray(g)||ue(g);f!==void 0&&g!==void 0&&!b?o.push({change:Ce,pathLeft:L,pathRight:h,valueLeft:f,valueRight:g}):(f!==void 0&&o.push({change:me,pathLeft:L,valueLeft:f}),g!==void 0&&o.push({change:fe,pathRight:h,valueRight:g}))}}return i(e,t,[],[]),o}function Xo(e){const t={};for(const o of e)if(o.change===me||o.change===Ce){const i=Re(o.pathLeft);t[i]=o.change,hn(o.pathLeft,f=>{const g=Re(f);t[g]||(t[g]=mn)}),o.change===me&&(Array.isArray(o.valueLeft)||ue(o.valueLeft))&&Be(o.valueLeft,o.pathLeft,(f,g)=>{const L=Re(g);t[L]=o.change})}return t}function Go(e){const t={};for(const o of e)if(o.change===fe||o.change===Ce){const i=Re(o.pathRight);t[i]=o.change,hn(o.pathRight,f=>{const g=Re(f);t[g]||(t[g]=mn)}),o.change===fe&&(Array.isArray(o.valueRight)||ue(o.valueRight))&&Be(o.valueRight,o.pathRight,(f,g)=>{const L=Re(g);t[L]=o.change})}return t}function Wo(e,t,o){let i=0,f=0;function g(h,b){return _e(e[h],t[b])}function L(h,b,P){const M=b-i,H=P-f,X=Math.min(M,H);for(let d=0;d<X;d++)o(Ce,i,f),i++,f++;for(;i<b;)o(me,i,f),i++;for(;f<P;)o(fe,i,f),f++;i+=h,f+=h}zo(e.length,t.length,g,L),L(0,e.length,t.length)}function Be(e,t,o){if(o(e,t),Array.isArray(e))for(let i=0;i<e.length;i++)Be(e[i],t.concat([i]),o);else ue(e)&&Object.keys(e).forEach(i=>{Be(e[i],t.concat([i]),o)})}function hn(e,t){for(let o=e.length-1;o>=0;o--){const i=e.slice(0,o);t(i)}}function Jt(e){return e&&typeof e.valueOf=="function"?e.valueOf():e}function Zo({copyLeftToRight:e,copyRightToLeft:t,transformLeftToRight:o,transformRightToLeft:i,toggleDiff:f,showDiff:g,diff:L,diffChangeCount:h,diffChangeIndex:b,toPreviousDiff:P,toNextDiff:M}){return r.jsxs("div",{className:"panel-actions",children:[r.jsxs("div",{className:"action-group",children:[r.jsx("div",{className:"action-group-name",children:"Copy"}),r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{onClick:t,className:"action-button rotatable",title:"Copy the contents of the right panel to the left panel",children:r.jsx(de,{icon:dt})}),r.jsx("button",{onClick:e,className:"action-button rotatable",title:"Copy the contents of the left panel to the right panel",children:r.jsx(de,{icon:ft})})]})]}),r.jsxs("div",{className:"action-group",children:[r.jsx("div",{className:"action-group-name",children:"Transform"}),r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{onClick:i,className:"action-button rotatable",title:"Transform the contents of the right panel into the left panel",children:r.jsx(de,{icon:dt})}),r.jsx("button",{onClick:o,className:"action-button rotatable",title:"Transform the contents of the left panel into the right panel",children:r.jsx(de,{icon:ft})})]})]}),r.jsxs("div",{className:"action-group",children:[r.jsx("div",{className:"action-group-name",children:"Differences"}),r.jsxs("button",{onClick:f,title:`Highlight the differences between left and right panel contents (currently ${g?"enabled":"disabled"})`,children:[r.jsx(de,{icon:g?bn:wo})," Compare"]})]}),r.jsx("div",{className:"action-group",children:g&&h!==void 0&&r.jsx("div",{className:"diff-form-contents",children:Ho(L)?r.jsx(qo,{error:L.error}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"diff-counter",children:(b>=0?b+1+"/":"")+(h+" difference")+(h!==1?"s":"")}),r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{onClick:P,title:"Go to previous difference",children:r.jsx(de,{icon:En})}),r.jsx("button",{onClick:M,title:"Go to next difference",children:r.jsx(de,{icon:xn})})]})]})})})]})}function er({onClose:e}){return r.jsx(on,{onRequestClose:e,className:"modal-sign-up-success-foreground",children:r.jsxs("div",{className:"modal modal-sign-up-success",children:[r.jsx("h1",{children:"Sign up successful"}),r.jsx("div",{children:'Thanks for signing up! Please click the "Sign in" button to automatically sign in now. Enjoy!'}),r.jsxs("div",{className:"modal-action-menu",children:[r.jsx("button",{className:"modal-button primary",onClick:()=>Te(),children:"Sign in"}),r.jsx("button",{className:"modal-button",onClick:()=>e(),children:"Later"})]})]})})}function tr({user:e,onClose:t}){const o=e?"Sign in again":"Sign in",i=e?"apply your subscription":"sign in and apply your subscription";return r.jsx(on,{onRequestClose:t,className:"modal-subscription-activated-foreground",children:r.jsxs("div",{className:"modal modal-subscription-activated",children:[r.jsx("h1",{children:"Subscription activated"}),r.jsxs("div",{children:[`ðŸŽ‰ Congrats, you've just activated a subscription! Please click the "`,o,'" button to automatically ',i,". Enjoy!"]}),r.jsxs("div",{className:"modal-action-menu",children:[r.jsx("button",{className:"modal-button primary",onClick:()=>Te(),children:o}),r.jsx("button",{className:"modal-button",onClick:()=>t(),children:"Later"})]})]})})}const nr=he("jsoneditoronline:SubscribePromo"),Yt=5*60*1e3,Bt=["red","orange","purple","pink","theme","blue","gray"],or=.9;function rr({subscribe:e}){const[t,o]=fn(),[i,f]=w.useState(L()),[g]=w.useState(Math.random()<or);w.useEffect(()=>{function h(){nr("update color"),o(),f(L()),t(h,Yt)}return t(h,Yt),o},[]);function L(){return Bt[Math.floor(Math.random()*Bt.length)]}return r.jsx("div",{className:"subscribe-promo-text",children:r.jsx("div",{className:"subscribe-promo-info",children:r.jsx("a",{href:"/pricing/",children:"Remove ads for $2"})})})}function sr(e){return en.includes(e)}function ar(e){let t,o;return(...i)=>(_e(i,t)||(t=i,o=e(...i)),o)}function cr(e,t=!0){const o=document.querySelector(e);o&&(o.scrollIntoView({behavior:"smooth"}),t&&setTimeout(()=>{location.hash=e},500))}function ir(e){ur(),setTimeout(()=>{cr(`[data-id="${e}"]`,!1)},100)}function ur(){document.documentElement.style.overflow="auto"}function lr(){document.documentElement.style.overflow="hidden",document.documentElement.scrollTop=0}const dr=he("jsoneditoronline:syncUtils");async function gn(){const t=St().filter(i=>yt(i)&&i.documentSource==="cloud").map(i=>i.document._id);if(wt(t))return[];dr("syncing cloud document ids with server",t);const o=await qn({add:t,remove:[]});return Ge(Zt,new Date().toISOString()),o}const Xt=Rn.lazy(async()=>Sn(()=>import("./JSONEditorPanel.yFWDitjL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]))),fr=1200,Gt=.15,Wt=.2,z=he("jsoneditoronline:App");z("backend url:",Dn);window.location.hostname==="localhost"&&(console.info('To see logging output in the console, set localStorage.debug and refresh the page. For example: localStorage.debug="*"'),console.info("Current value of localStorage.debug:",window.localStorage.debug));console.info(`Hi developer! You can access the editors and use the following JSON utility libraries in the developer console:

NAME         DESCRIPTION             DOCUMENTATION                                         
_            Lodash utility library  https://lodash.com/
jsonrepair   JSON repair library     https://github.com/josdejong/jsonrepair/
Ajv          JSON Schema validator   https://ajv.js.org/
jsonquery    JSON query language     https://jsonquerylang.org/
jmespath     JSON query language     https://jmespath.org/
JSONPath     JSON query language     https://github.com/JSONPath-Plus/JSONPath/
patch        JSON Patch library      https://github.com/josdejong/immutable-json-patch/
editorLeft   Left JSON Editor        https://github.com/josdejong/svelte-jsoneditor/
editorRight  Right JSON Editor       https://github.com/josdejong/svelte-jsoneditor/

EXAMPLES
_.sortBy([{id: 3}, {id: 1}, {id: 2}], "id")
jsonrepair("{name: John")
new Ajv().validate(schema, data)
jsonquery(data, query)
jmespath.search(data, query)
JSONPathPlus({ json, path: '$.store.book[*].author' })
patch.immutableJSONPatch(data, operations)
editorLeft.get()
editorRight.get()

`);const lt=/\?(id|url|json)=(.+)/.exec(window.location.search);if(lt){const e=lt[1],t=lt[2],i=`${e==="id"?"cloud":e}.${t}`;z("Change legacy url search parameters into hash parameters"),window.location.href=`${window.location.origin}/#left=${i}`}const mr=ar(function(e,t,o,i){try{const f=Mt(e,t),g=Mt(o,i),L=Date.now(),h=Yo(f,g),b=Date.now();return z(`Calculated diff in ${b-L} milliseconds`,h),h}catch(f){return{changes:[],diffLeft:{},diffRight:{},error:f}}}),E=ln();function pn(e){e&&e!=="/callback"?ir(hr(e)):window.scrollTo(0,0)}function hr(e){return e.startsWith("/")?e.substring(1):e}E.onChangeSection(pn);lr();pn(E.getSection());window.addEventListener("resize",()=>{document.documentElement.style.overflow==="hidden"&&document.documentElement.clientWidth>980&&(document.documentElement.scrollTop=0)});function yn(){window.scrollY===0&&E.getSection()&&(z("clear section"),E.setSection(void 0))}addEventListener("wheel",yn);addEventListener("touchmove",yn);let wn=!1,vn=!1;if(E.getSection()==="/callback"){E.setSection(void 0),z("callback",E.getQueryParams()),E.getQueryParam("sign_up")&&(E.removeQueryParam("sign_up"),z("user signed up via memberful"),wn=!0),E.getQueryParam("sign_in")&&(E.removeQueryParam("sign_in"),z("user signed in via memberful")),E.getQueryParam("sign_out")&&(E.removeQueryParam("sign_out"),z("user signed out via memberful"),Qn(_n)),E.getQueryParam("subscription_activated")&&(E.removeQueryParam("subscription_activated"),z("user activated a subscription via memberful"),vn=!0);const f=E.getQueryParam("access_token");f&&E.removeQueryParam("access_token");const g=E.getQueryParam("refresh_token");g&&E.removeQueryParam("refresh_token");const L=E.getQueryParam("expires_in");L&&E.removeQueryParam("expires_in");const h=E.getQueryParam("token_type");if(h&&E.removeQueryParam("token_type"),f&&g&&L&&h){const b={access_token:f,refresh_token:g,expires_in:parseInt(L,10),token_type:h},P=Vn(b);zn(P),gn().catch(M=>console.error("Failed to sync user document ids",M))}}{const e=E.getHash();if(z("currentHash",e),wt(e.query)){const o=gt(localStorage[jt]||"");z("load last query params",{lastQuery:o,currentHash:e}),E.setQueryParams(o)}E.onChangeHash(o=>{z("save last query params",{query:o.query}),localStorage[jt]=dn(o.query)});const t="lastHash";delete localStorage[t]}function Xe(e,t){return e?sr(e)?!0:(console.warn(`Invalid value "${e}" for hash parameter "${t}". Choose from: ${en.join(", ")}.`),!1):!1}{const e=E.getQueryParam(De);Xe(e,De)&&(localStorage[tn]=JSON.stringify(e))}{const e=E.getQueryParam(Pe);Xe(e,Pe)&&(localStorage[nn]=JSON.stringify(e))}!localStorage[Zt]&&Hn()&&gn().catch(e=>console.error("Failed to sync user document ids",e));localStorage[Lt]||(localStorage[Lt]=new Date().toISOString(),un().then(()=>{z("migration done")}));function Pr(){const e=Uo(),[t,o]=Xn(),[i,f]=w.useState(t.indentation),[g,L]=Fe(tn,Se.text),[h,b]=Fe(nn,Se.tree),[P,M]=Fe(Nn,.5),[H,X]=Fe("formattingOnSave",He.KEEP),[d,p]=w.useState(!1),[y,v]=w.useState(!1),[u,l]=Fe("showDiff",!1),[C,S]=w.useState(!1),[R,x]=w.useState(null),[m,q]=w.useState(null),[Q,J]=w.useState(null),[I,K]=w.useState(vn),[oe,W]=w.useState(wn),[j,k]=w.useState(!1),$=Jn(),B=$.user?Yn($.user):!1,N=$t({hashKey:"left",indentation:t.indentation,maxLineLength:t.maxLineLength,parserId:t.parserId,loadDefaultDocumentOnFirstUse:!0,signIn:Te,subscribe:pe}),O=$t({hashKey:"right",indentation:t.indentation,maxLineLength:t.maxLineLength,parserId:t.parserId,loadDefaultDocumentOnFirstUse:!1,signIn:Te,subscribe:pe}),V=t.theme===nt.AUTO&&e===nt.DARK||t.theme===nt.DARK,Z=V?"jse-theme-dark":"jse-theme-light";w.useEffect(()=>{document.body.classList.toggle("jse-ad-free-subscription",B),document.body.classList.toggle("jse-no-ad-free-subscription",!B)},[B]),w.useEffect(()=>{document.body.classList.toggle("jse-theme-light",!V),document.body.classList.toggle("jse-theme-dark",V),m?.refresh(),Q?.refresh()},[Z]);const U=ye[t.themeColor];w.useEffect(()=>{document.body.classList.toggle(ye[xe.GREEN],ye[xe.GREEN]===U),document.body.classList.toggle(ye[xe.BLUE],ye[xe.BLUE]===U),document.body.classList.toggle(ye[xe.RED],ye[xe.RED]===U)},[U]),w.useEffect(()=>{t.indentation!==i&&(f(t.indentation),z(`change indentation to ${t.indentation}`),et(t.indentation))},[t.indentation,i]),w.useEffect(()=>{if(z(`change font-size to ${t.fontSize}`),!ho(t.fontSize)){console.warn(`Cannot apply font-size: invalid font size "${t.fontSize}"`);return}const c=document.documentElement;if(!c){console.warn("Cannot apply font-size: no root found");return}c.style.setProperty("--jse-font-size-mono",t.fontSize),g==="text"&&m&&m.refresh(),h==="text"&&Q&&Q.refresh()},[t.fontSize]),w.useEffect(()=>{window.location.protocol==="http:"&&window.location.hostname!=="localhost"&&it({text:r.jsxs(r.Fragment,{children:["You're using an unsecured url (http). Please switch to the secure url"," ",r.jsx("a",{href:"https://jsoneditoronline.org",children:"https://jsoneditoronline.org"})," and update any bookmarks. ",r.jsx("a",{href:"/changelog.html#2022-07-04-version-634",children:"Read more"}),"."]}),closable:!0})},[]),w.useEffect(()=>{const c=E.onChangeQueryParam(De,T=>{Xe(T,De)&&L(T)});return()=>{E.removeListener(c)}},[]),w.useEffect(()=>{E.getQueryParam(De)!==g&&E.removeQueryParam(De)},[g]),w.useEffect(()=>{const c=E.onChangeQueryParam(Pe,T=>{Xe(T,Pe)&&b(T)});return()=>{E.removeListener(c)}},[]),w.useEffect(()=>{function c(_){switch(_){case"left":M(1);break;case"right":M(0);break;case"both":M(.5);break;case void 0:break;default:console.warn(`Invalid value "${_}" for hash parameter "panels". Choose from: left, right, both.`)}}c(E.getQueryParam(ot));const T=E.onChangeQueryParam(ot,c);return()=>{E.removeListener(T)}},[]),w.useEffect(()=>{function c(_){switch(_){case"true":Y(!0);break;case"false":Y(!1);break;case void 0:break;default:console.warn(`Invalid value "${_}" for hash parameter "compare". Choose from: true, false.`)}}c(E.getQueryParam(qe));const T=E.onChangeQueryParam(qe,c);return()=>{E.removeListener(T)}},[]);function Y(c){l(c);const T=E.getQueryParam(qe);T&&T!==String(c)&&E.removeQueryParam(qe)}w.useEffect(()=>{E.getQueryParam(Pe)!==h&&E.removeQueryParam(Pe)},[h]);function G(c){M(c),E.removeQueryParam(ot)}const ee=w.useRef(null),se=w.useRef(null);Io({setSplitterValue:G,onClick:be,refContainer:ee,refSplitter:se});const ce=P>=Gt,re=P<=1-Gt,le=ce&&re,Le=ce?re?jn:dt:ft;function be(){ce||G(Wt),re||G(1-Wt)}function pe(){k(!0)}const Oe=[{panelId:Et,compoundKey:N.compoundKey,content:N.content},{panelId:xt,compoundKey:O.compoundKey,content:O.content}];function Ne(c,T,_){return!Bn(T,_)&&_===JSON?po(c,T,t.indentation):c}function Me(c,T,_){const ae=_t(c)?{text:Ot(c.text,T,t.indentation)}:c;return Ne(ae,T,_)}async function We(){await O.updateContent(Me(N.content,N.parser,O.parser))}async function Ze(){await N.updateContent(Me(O.content,O.parser,N.parser))}async function et(c){z("applyIndentation",c),await T(N),await T(O);async function T(_){const ae=_.content;_t(ae)&&!wt(ae.text)&&await _.updateContent({text:Ot(ae.text,_.parser,c)})}}function ke(c){o(T=>({...T,queryLanguageId:c}))}function Ke(){m?.transform({id:Pn,onTransform:async({transformedJson:c})=>{z("transform left to right");const T={json:c};await O.updateContent(Ne(T,N.parser,O.parser))},onClose:()=>{setTimeout(()=>Q?.focus())}})}function tt(){Q?.transform({id:Tn,onTransform:async({transformedJson:c})=>{z("transform left to right");const T={json:c};await N.updateContent(Ne(T,O.parser,N.parser))},onClose:()=>{setTimeout(()=>m?.focus())}})}function Ee(){u?Y(!1):(Y(!0),x(null),(g!==Se.tree||h!==Se.tree)&&it({text:"Highlighting of differences between left and right panel is only available in tree mode.",action:{text:"Switch to tree mode",onClick:()=>{L(Se.tree),b(Se.tree)}},closable:!0,className:"wide"}))}function $e(){if(!u)return;const T=(Rt(N.content,ze)||Rt(O.content,ze))&&!C;if(T){setTimeout(()=>{Y(!1);const _=it({text:r.jsxs("div",{children:["Diff calculation is turned off: documents are too large (exceeding"," ",Ye(ze),") and may crash your browser. Do you really want to compare these documents?"," ",r.jsx("button",{type:"button",className:"action",onClick:()=>{_.close(),S(!0),setTimeout(()=>{Y(!0)})},children:"Yes"})," ","|"," ",r.jsx("button",{type:"button",className:"action",onClick:()=>{_.close()},children:"No"})]}),closable:!0,timeout:6e4})});return}return u&&!T?mr(N.content,N.parser,O.content,O.parser):void 0}const n=$e(),a=ne(R),s=n&&n.changes?n.changes.length:void 0;function D(){const c=n?.changes;if(!c)return;const T=a>0?a-1:0,_=c[T];_&&Ie(_)}function F(){const c=n?.changes;if(!c)return;const T=a<c.length-1?a+1:c.length-1,_=c[T];_&&Ie(_)}function ne(c){if(!c||!n||!n.changes)return-1;const T=n.changes.findIndex(_=>_e(_,c));return T!==-1?T:n.changes.findIndex(_=>_.change!==fe&&c.change!==fe&&_e(_.pathLeft,c.pathLeft)||_.change!==me&&c.change!==me&&_e(_.pathRight,c.pathRight))}function Ie(c){const T=c?c.change!==fe?c.pathLeft:c.pathRight:null;if(x(c),z("scrollTo",T,{changes:n?.changes,path:T,leftEditorRef:m,rightEditorRef:Q}),m&&(c.change===me||c.change===Ce)){const _=c.pathLeft.map(String);m.scrollTo(_).then(()=>{const ae=m.findElement(_);ae&&Ct(ae),z("left panel: scroll to node",{element:ae,path:c.pathLeft})})}if(Q&&(c.change===fe||c.change===Ce)){const _=c.pathRight.map(String);Q.scrollTo(_).then(()=>{const ae=Q.findElement(_);ae&&Ct(ae),z("right panel: scroll to node",{element:ae,path:c.pathRight})})}}function Ct(c){setTimeout(()=>c.classList.add("blink-diff-value")),setTimeout(()=>c.classList.remove("blink-diff-value"),fr)}function Ue(c){[N,O].filter(_=>_.compoundKey===c).forEach(_=>{z("close document",_),_.closeDocument()})}return r.jsxs("div",{className:"app",children:[I&&r.jsx(tr,{user:$.user,onClose:()=>K(!1)}),oe&&r.jsx(er,{onClose:()=>W(!1)}),r.jsxs("div",{className:"body",children:[r.jsxs("div",{ref:ee,className:"contents-panel",children:[ce&&r.jsx("div",{className:bt("left-panel",{focus:d}),style:{flex:le?P:1},children:r.jsx(zt,{children:r.jsx(w.Suspense,{fallback:r.jsx(Vt,{mode:g}),children:r.jsx(Xt,{auth:$,panelId:Et,jsonEditorRef:m,setJsonEditorRef:c=>{q(c),window.editorLeft=c,E.getHash().section===void 0&&setTimeout(()=>c.focus())},focus:d,setFocus:p,mode:g,setMode:L,indentation:t.indentation,tabSize:t.tabSize,maxLineLength:t.maxLineLength,formattingOnSave:H,setFormattingOnSave:X,escapeControlCharacters:t.escapeControlCharacters,escapeUnicodeCharacters:t.escapeUnicodeCharacters,flattenColumns:t.flattenColumns,queryLanguageId:t.queryLanguageId,onChangeQueryLanguage:ke,allPanels:Oe,closeAndForgetDocument:async c=>{Ue(c),await N.forgetDocument(c)},closeAndDeleteDocument:async c=>{Ue(c),await N.deleteDocument(c)},documentProvider:N,diff:n?n.diffLeft:null,onSignIn:Te,onSubscribe:pe},N.documentSequenceNr)})})}),r.jsxs("div",{className:"center-panel",children:[le&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"empty-space-top"}),r.jsx(Zo,{copyLeftToRight:We,copyRightToLeft:Ze,transformLeftToRight:Ke,transformRightToLeft:tt,toggleDiff:Ee,showDiff:u,diff:n,diffChangeCount:s,diffChangeIndex:a,toPreviousDiff:D,toNextDiff:F})]}),r.jsx("div",{ref:se,className:"draggable-splitter",title:"Drag left or right to change the width of the panels",children:r.jsx("div",{className:"draggable-splitter-icon",children:r.jsx(de,{icon:Le,fixedWidth:!0})})})]}),re&&r.jsx("div",{className:bt("right-panel",{focus:y}),style:{flex:le?1-P:1},children:r.jsx(zt,{children:r.jsx(w.Suspense,{fallback:r.jsx(Vt,{mode:h}),children:r.jsx(Xt,{auth:$,panelId:xt,jsonEditorRef:Q,setJsonEditorRef:c=>{J(c),window.editorRight=c},focus:y,setFocus:v,mode:h,setMode:b,indentation:t.indentation,tabSize:t.tabSize,maxLineLength:t.maxLineLength,formattingOnSave:H,setFormattingOnSave:X,escapeControlCharacters:t.escapeControlCharacters,escapeUnicodeCharacters:t.escapeUnicodeCharacters,flattenColumns:t.flattenColumns,queryLanguageId:t.queryLanguageId,onChangeQueryLanguage:ke,allPanels:Oe,closeAndForgetDocument:async c=>{Ue(c),await N.forgetDocument(c)},closeAndDeleteDocument:async c=>{Ue(c),await O.deleteDocument(c)},documentProvider:O,diff:n?n.diffRight:null,onSignIn:Te,onSubscribe:pe},O.documentSequenceNr)})})})]}),!B&&r.jsxs("div",{className:"ad-panel",children:[r.jsx(go,{}),r.jsx(rr,{subscribe:pe})]})]}),j&&r.jsx(So,{onClose:()=>k(!1)})]})}export{Pr as A,Se as M,lr as d,St as l,ar as m,fn as u};
